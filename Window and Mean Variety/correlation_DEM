/**** Start of imports. If edited, may not auto-convert in the playground. ****/
var image = ee.Image("NASA/NASADEM_HGT/001"),
    image2 = ee.Image("projects/ee-resilience/assets/hand_am");
/***** End of imports. If edited, may not auto-convert in the playground. *****/

var palettes=require('users/gena/packages:palettes');// https://github.com/gee-community/ee-palettes


var palette = palettes.colorbrewer.Spectral[7].reverse();
var limite = image2.geometry()

Map.addLayer(image.select('elevation').clip(limite), {min:16 ,max:249 , palette:palette}, 'NASADEM')

Map.addLayer(image2, {min: 12,max:127, palette: palette }, 'DEM schietti')

var img = ee.Image.cat([image.select('elevation').clip(limite), image2]).rename(["nasa", "schietti"]);

var values = img.sample({ region: limite, scale: image.projection().nominalScale(), numPixels: 5000});

var chart = ui.Chart.feature.byFeature(values, 'schietti', ['nasa'])
  .setChartType('ScatterChart')
  .setOptions({ pointSize: 5, pointColor: 'red', width: 300, height: 300, titleX: 'nasa', titleY: 'schietti' })
   
   
print(chart)  

print(values.reduceColumns({reducer:ee.Reducer.spearmansCorrelation(), 
                            selectors:["nasa", "schietti"]}))


// Set the parameters for cross-correlation
var maxGap = 0; // The greatest distance a pixel may shift in either X or Y.
var windowSize = 3; // Size of the window to be compared.
var maxMaskedFrac = 0; // The maximum fraction of pixels within the correlation window that are allowed to be masked.

// Perform cross-correlation
var crossCorrelation = ee.Algorithms.CrossCorrelation(image2, image.select('elevation').clip(limite), maxGap, windowSize, maxMaskedFrac);

// Visualize the cross-correlation
Map.addLayer(crossCorrelation, {min: -1, max: 1}, 'Cross-Correlation');

